webpackJsonp([11,19],{TPCp:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=t("4YfN"),n=t.n(o),i=t("JpjP"),s=t("JABh"),r=t("hELL"),l=t("h+i8"),c={name:"Company",components:{CompanyAdd:r.default,CompanyEdit:l.default,RangeDate:i.a,Info:s.a},data:function(){return{advanced:!1,dataSource:[],selectedRowKeys:[],queryParams:{},sortedInfo:null,info:{visiable:!1,label:{top:{companyId:"企业ID",companyName:"企业名称",linkman:"联系人",linkphone:"联系电话",province:"省",city:"市",area:"县",postcode:"邮编",address:"详细地址",lng:"经度",lat:"纬度",createTime:"创建时间",modifyTime:"修改时间"},bottom:{introduce:"企业介绍"}},data:{},images:[]},pagination:{defaultPageSize:1e7,hideOnSinglePage:!0,indentSize:100},loading:!1,companyAddVisiable:!1,companyEditVisiable:!1}},computed:{columns:function(){var e=this.sortedInfo;return[{title:"企业名称",dataIndex:"companyName"},{title:"企业编号",dataIndex:"companyNumber"},{title:"联系人",dataIndex:"linkman"},{title:"联系电话",dataIndex:"linkphone"},{title:"省",dataIndex:"province"},{title:"市",dataIndex:"city"},{title:"县",dataIndex:"area"},{title:"创建时间",dataIndex:"createTime",sorter:!0,sortOrder:"createTime"===(e=e||{}).columnKey&&e.order},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:120}]}},mounted:function(){this.fetch()},methods:{view:function(e){this.info.data=e,this.info.images=[e.picture],this.info.visiable=!0},handleInfoClose:function(){this.info.visiable=!1},onSelectChange:function(e){this.selectedRowKeys=e},handleCompanyAddClose:function(){this.companyAddVisiable=!1},handleCompanyAddSuccess:function(){this.companyAddVisiable=!1,this.$message.success("新增企业成功"),this.fetch()},add:function(){this.companyAddVisiable=!0},handleCompanyEditClose:function(){this.companyEditVisiable=!1},handleCompanyEditSuccess:function(){this.companyEditVisiable=!1,this.$message.success("修改企业成功"),this.fetch()},edit:function(e){this.companyEditVisiable=!0,this.$refs.companyEdit.setFormValues(e)},handleDateChange:function(e){e&&(this.queryParams.createTimeFrom=e[0],this.queryParams.createTimeTo=e[1])},batchDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除！",centered:!0,onOk:function(){e.$delete("admin/company/"+e.selectedRowKeys.join(",")).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.fetch()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},exportExcel:function(){var e=this.sortedInfo,a=void 0,t=void 0;e&&(a=e.field,t=e.order),this.$export("admin/company/excel",n()({sortField:a,sortOrder:t},this.queryParams))},search:function(){var e=this.sortedInfo,a=void 0,t=void 0;e&&(a=e.field,t=e.order),this.fetch(n()({sortField:a,sortOrder:t},this.queryParams))},reset:function(){this.selectedRowKeys=[],this.sortedInfo=null,this.queryParams={},this.$refs.createTime.reset(),this.fetch()},handleTableChange:function(e,a,t){this.sortedInfo=t,this.fetch(n()({sortField:t.field,sortOrder:t.order},this.queryParams,a))},fetch:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.$get("admin/company",n()({},a)).then(function(a){var t=a.data;e.dataSource=t.rows;var o=n()({},e.pagination);o.total=t.total,e.pagination=o,e.loading=!1})}}},m={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[t("div",{class:e.advanced?"search":null},[t("a-form",{attrs:{layout:"horizontal"}},[t("div",{class:e.advanced?null:"fold"},[t("a-row",[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"名称",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("a-input",{model:{value:e.queryParams.companyName,callback:function(a){e.$set(e.queryParams,"companyName",a)},expression:"queryParams.companyName"}})],1)],1),e._v(" "),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{label:"创建时间",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[t("range-date",{ref:"createTime",on:{change:e.handleDateChange}})],1)],1)],1)],1),e._v(" "),t("span",{staticStyle:{float:"right","margin-top":"3px"}},[t("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)])],1),e._v(" "),t("div",[t("div",{staticClass:"operator"},[t("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"admin:company:add",expression:"'admin:company:add'"}],attrs:{type:"primary",ghost:""},on:{click:e.add}},[e._v("新增")]),e._v(" "),t("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"admin:company:delete",expression:"'admin:company:delete'"}],on:{click:e.batchDelete}},[e._v("删除")]),e._v(" "),t("a-dropdown",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"admin:company:export",expression:"'admin:company:export'"}]},[t("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[t("a-menu-item",{key:"export-data",on:{click:e.exportExcel}},[e._v("导出Excel")])],1),e._v(" "),t("a-button",[e._v("\n          更多操作\n          "),t("a-icon",{attrs:{type:"down"}})],1)],1)],1),e._v(" "),t("a-table",{attrs:{columns:e.columns,dataSource:e.dataSource,rowKey:"companyId",pagination:e.pagination,loading:e.loading,scroll:{x:900},rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"operation",fn:function(a,o){return[t("a-icon",{attrs:{type:"eye",theme:"twoTone",twoToneColor:"#42b983",title:"查看"},on:{click:function(a){e.view(o)}}}),e._v(" "),t("a-icon",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"admin:company:update",expression:"'admin:company:update'"}],attrs:{type:"edit",theme:"twoTone",twoToneColor:"#faad14",title:"修改"},on:{click:function(a){e.edit(o)}}}),e._v(" "),t("a-badge",{directives:[{name:"hasNoPermission",rawName:"v-hasNoPermission",value:"admin:company:update",expression:"'admin:company:update'"}],attrs:{status:"warning",text:"无权限"}})]}}])})],1),e._v(" "),t("company-add",{attrs:{companyAddVisiable:e.companyAddVisiable},on:{success:e.handleCompanyAddSuccess,close:e.handleCompanyAddClose}}),e._v(" "),t("company-edit",{ref:"companyEdit",attrs:{companyEditVisiable:e.companyEditVisiable},on:{success:e.handleCompanyEditSuccess,close:e.handleCompanyEditClose}}),e._v(" "),t("info",{attrs:{data:e.info.data,images:e.info.images,label:e.info.label,infoVisiable:e.info.visiable},on:{close:e.handleInfoClose}})],1)},staticRenderFns:[]};var d=t("C7Lr")(c,m,!1,function(e){t("sCSV")},"data-v-49a648a3",null);a.default=d.exports},hELL:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=t("ZLEe"),n=t.n(o),i=t("luk7"),s=t.n(i),r=t("UZ5G"),l=t("AS2Z"),c={labelCol:{span:3},wrapperCol:{span:18}},m={name:"CompanyAdd",components:{VMap:r.a,UploadImage:l.a,VDistpicker:s.a},props:{companyAddVisiable:{default:!1}},data:function(){return{loading:!1,showMapComponent:!1,formItemLayout:c,form:this.$form.createForm(this),fileList:[],select:{province:"",city:"",area:"",postcode:""}}},methods:{reset:function(){this.loading=!1,this.select.province="",this.select.city="",this.select.area="",this.select.postcode="",this.form.resetFields(),this.fileList=[],this.$refs.uploadImageChild.finished()},selectProvince:function(e){this.select.province=e.value},selectCity:function(e){this.select.city=e.value},selectArea:function(e){this.select.area=e.value,this.select.postcode=e.code},handleFileSelect:function(e){this.fileList.push(e)},handleFileRemove:function(e){this.fileList.splice(e,1)},showMap:function(){this.showMapComponent=!0},confirmMap:function(e,a){this.form.setFieldsValue({address:a,lng:e.lng,lat:e.lat}),this.showMapComponent=!1},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(a,t){if(!a){if(2!==e.fileList.length)return void e.$message.error("请选择两张图片");e.loading=!0,t.province=e.select.province,t.city=e.select.city,t.area=e.select.area,t.postcode=e.select.postcode;var o=new FormData;n()(t).forEach(function(e){t[e]&&o.append(e,t[e])}),e.fileList.forEach(function(e,a){var t=e.type.split("/")[1];o.append("files",e,"file_"+Date.parse(new Date)+"."+t)}),e.$upload("admin/company",o).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})}}},d={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"新增企业",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.companyAddVisiable},on:{close:e.onClose}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",e._b({attrs:{label:"企业名称"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["companyName",{rules:[{required:!0,message:"不能为空"}]}],expression:"['companyName',\n                 {rules: [\n                  { required: true, message: '不能为空'}\n                ]}]"}],staticStyle:{width:"100%"}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"企业编号"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["companyNumber",{rules:[{max:50,message:"长度不能超过50个字符"}]}],expression:"[\n        'companyNumber',\n        {rules: [\n          { max: 50, message: '长度不能超过50个字符'}\n        ]}]"}]})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"企业介绍"}},"a-form-item",e.formItemLayout,!1),[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["introduce",{rules:[{max:1e3,message:"长度不能超过1000个字符"}]}],expression:"[\n        'introduce',\n        {rules: [\n          { max: 1000, message: '长度不能超过1000个字符'}\n        ]}]"}],attrs:{rows:4}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"监管政府"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["government",{rules:[{max:50,message:"长度不能超过50个字符"}]}],expression:"[\n        'government',\n        {rules: [\n          { max: 50, message: '长度不能超过50个字符'}\n        ]}]"}]})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"联系人"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["linkman",{rules:[{max:50,message:"长度不能超过50个字符"}]}],expression:"[\n        'linkman',\n        {rules: [\n          { max: 50, message: '长度不能超过50个字符'}\n        ]}]"}]})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"联系电话"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["linkphone",{rules:[{max:20,message:"长度不能超过20个字符"}]}],expression:"[\n        'linkphone',\n        {rules: [\n          { max: 20, message: '长度不能超过20个字符'}\n        ]}]"}]})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"地址"}},"a-form-item",e.formItemLayout,!1),[t("v-distpicker",{attrs:{province:e.select.province,city:e.select.city,area:e.select.area,wrapper:"address-wrapper"},on:{province:e.selectProvince,city:e.selectCity,area:e.selectArea}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"邮编"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{model:{value:e.select.postcode,callback:function(a){e.$set(e.select,"postcode",a)},expression:"select.postcode"}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"详细地址"}},"a-form-item",e.formItemLayout,!1),[t("a-row",{attrs:{gutter:8}},[t("a-col",{attrs:{span:12}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{max:100,message:"长度不能超过100个字符"}]}],expression:"[\n            'address',\n            {rules: [\n              { max: 100, message: '长度不能超过100个字符'}\n            ]}]"}]})],1),e._v(" "),t("a-col",{attrs:{span:12}},[t("a-button",{on:{click:e.showMap}},[e._v("选择地址")])],1)],1),e._v(" "),t("v-map",{attrs:{showMapComponent:e.showMapComponent},on:{"map-confirm":e.confirmMap}})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"经度"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lng"],expression:"['lng']"}]})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"纬度"}},"a-form-item",e.formItemLayout,!1),[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lat"],expression:"['lat']"}]})],1),e._v(" "),t("a-form-item",e._b({attrs:{label:"商标和图片"}},"a-form-item",e.formItemLayout,!1),[t("p",{staticStyle:{color:"red"}},[e._v("请选择两张图片，第一张为商标，第二张为公司展示图片")]),e._v(" "),t("upload-image",{ref:"uploadImageChild",attrs:{limitNum:"2"},on:{fileSelect:e.handleFileSelect,fileRemove:e.handleFileRemove}})],1)],1),e._v(" "),t("div",{staticClass:"drawer-bootom-button"},[t("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[t("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),t("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]};var p=t("C7Lr")(m,d,!1,function(e){t("tbZL")},"data-v-f9ddd544",null);a.default=p.exports},sCSV:function(e,a){},tbZL:function(e,a){}});
//# sourceMappingURL=11.597307c57e5af341889b.js.map