webpackJsonp([34],{"0xBd":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("4YfN"),i=a.n(n),o={name:"ApplyAudit",components:{Info:a("JABh").a},data:function(){return{current_user:this.$store.state.account.user,advanced:!1,dataSource:[],selectedRowKeys:[],queryParams:{},sortedInfo:null,loading:!1,applyId:null,paginationInfo:null,info:{visiable:!1,label:{top:{batchId:"批次号",num:"申请数量",applicant:"申请人",auditor:"审核人",startId:"码段开始值",endId:"码段结束值",applyTime:"申请时间",auditTime:"审核时间",status:"状态"}},data:{}},pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(t,e){return"显示 "+e[0]+" ~ "+e[1]+" 条记录，共 "+t+" 条记录"}}}},computed:{columns:function(){var t=this.sortedInfo;return[{title:"批次号",dataIndex:"batchId"},{title:"申请数量",dataIndex:"num"},{title:"申请人",dataIndex:"applicant"},{title:"码段开始值",dataIndex:"startId"},{title:"码段结束值",dataIndex:"endId"},{title:"申请时间",dataIndex:"applyTime",sorter:!0,sortOrder:"applyTime"===(t=t||{}).columnKey&&t.order},{title:"审核时间",dataIndex:"auditTime"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:120}]},rowSelection:function(){var t=this;return{onChange:function(e,a){t.selectedRowKeys=e}}}},mounted:function(){this.fetch()},methods:{view:function(t){this.info.data=t,this.info.visiable=!0},handleInfoClose:function(){this.info.visiable=!1},audit:function(t,e){var a=this;this.$put("apply",{applyId:t,status:e}).then(function(){a.$message.success("审核成功"),a.fetch()}).catch(function(){a.$message.success("审核失败")})},applyDelete:function(){if(this.selectedRowKeys.length){var t=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除！",centered:!0,onOk:function(){t.$delete("apply/"+t.selectedRowKeys.join(",")).then(function(){t.$message.success("删除成功"),t.selectedRowKeys=[],t.search()})},onCancel:function(){t.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},search:function(){var t=this.sortedInfo,e=void 0,a=void 0;t&&(e=t.field,a=t.order),this.fetch(i()({sortField:e,sortOrder:a},this.queryParams))},reset:function(){this.selectedRowKeys=[],this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(t,e,a){this.paginationInfo=t,this.filteredInfo=e,this.sortedInfo=a,this.fetch(i()({sortField:a.field,sortOrder:a.order},this.queryParams,e))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,e.creator=this.current_user.username,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,e.pageSize=this.paginationInfo.pageSize,e.pageNum=this.paginationInfo.current):(e.pageSize=this.pagination.defaultPageSize,e.pageNum=this.pagination.defaultCurrent),this.$get("admin/apply/page",i()({},e)).then(function(e){var a=e.data;t.dataSource=a.rows;var n=i()({},t.pagination);n.total=a.total,t.pagination=n,t.loading=!1})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{class:t.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:t.advanced?null:"fold"},[a("a-row",[a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"批次号",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:t.queryParams.batchId,callback:function(e){t.$set(t.queryParams,"batchId",e)},expression:"queryParams.batchId"}})],1)],1),t._v(" "),a("a-col",{attrs:{md:12,sm:24}},[a("span",{staticStyle:{float:"left","margin-top":"3px","margin-left":"15px"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")]),t._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.reset}},[t._v("重置")])],1)])],1)],1)])],1),t._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"apply:delete",expression:"'apply:delete'"}],attrs:{type:"primary",ghost:""},on:{click:t.applyDelete}},[t._v("删除")])],1),t._v(" "),a("a-table",{ref:"TableInfo",attrs:{columns:t.columns,dataSource:t.dataSource,rowKey:"applyId",pagination:t.pagination,loading:t.loading,scroll:{x:900},rowSelection:t.rowSelection},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"status",fn:function(e){return a("span",{},[0===e?a("a-tag",{attrs:{color:"blue"}},[t._v("未审核")]):1===e?a("a-tag",{attrs:{color:"green"}},[t._v("审核通过")]):2===e?a("a-tag",{attrs:{color:"red"}},[t._v("审核不通过")]):t._e()],1)}},{key:"operation",fn:function(e,n){return[a("div",[a("a-icon",{attrs:{type:"eye",theme:"twoTone",twoToneColor:"#42b983",title:"查看"},on:{click:function(e){t.view(n)}}}),t._v(" "),0===n.status?a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[a("a-icon",{attrs:{type:"pushpin",theme:"twoTone",twoToneColor:"blue",title:"审核"}})],1),t._v(" "),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{on:{click:function(e){t.audit(n.applyId,1)}}},[a("a-icon",{attrs:{type:"check"}}),t._v(" 批准")],1)]),t._v(" "),a("a-menu-item",[a("a",{on:{click:function(e){t.audit(n.applyId,2)}}},[a("a-icon",{attrs:{type:"close"}}),t._v(" 不批准")],1)])],1)],1):t._e()],1)]}}])})],1),t._v(" "),a("info",{attrs:{data:t.info.data,label:t.info.label,infoVisiable:t.info.visiable},on:{close:t.handleInfoClose}})],1)},staticRenderFns:[]};var r=a("C7Lr")(o,s,!1,function(t){a("7UIA")},"data-v-2ae7bf39",null);e.default=r.exports},"7UIA":function(t,e){}});
//# sourceMappingURL=34.68f1386cfb5418bc3f75.js.map