webpackJsonp([1,70,71],{"4ACn":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("4YfN"),r=o.n(i),n=o("ZLEe"),a=o.n(n),s=o("A9zj"),l=o.n(s),c={labelCol:{span:3},wrapperCol:{span:18}},d={name:"MonitorEdit",props:{monitorEditVisiable:{default:!1}},data:function(){return{loading:!1,formItemLayout:c,form:this.$form.createForm(this),videoId:"",value:1}},methods:{reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},setFormValues:function(e){var t=this,o=l()(e,[]),i=["ownerId","title","url","token"],r={};this.videoId=o.videoId,a()(o).forEach(function(e){-1!==i.indexOf(e)&&(t.form.getFieldDecorator(e),r[e]=o[e],t.form.setFieldsValue(r))}),o.token?this.value=1:this.value=2},handleSubmit:function(){var e=this;this.form.validateFields(function(t,o){if(!t){e.loading=!0;var i=e.form.getFieldsValue();i.videoId=e.videoId,1!==e.value&&(i.token=null),e.$put("video",r()({},i)).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})}}},u={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"修改监控",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.monitorEditVisiable},on:{close:e.onClose}},[o("a-form",{attrs:{form:e.form}},[o("a-form-item",e._b({attrs:{label:"企业编号"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ownerId"],expression:"['ownerId']"}],attrs:{readOnly:""}})],1),e._v(" "),o("a-form-item",e._b({attrs:{label:"类型"}},"a-form-item",e.formItemLayout,!1),[o("a-radio-group",{model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[o("a-radio",{attrs:{value:1}},[e._v("监控")]),e._v(" "),o("a-radio",{attrs:{value:2}},[e._v("直播")])],1)],1),e._v(" "),o("a-form-item",e._b({attrs:{label:"监控名称"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{max:50,message:"长度不能超过50个字符"},{required:!0,message:"不能为空"}]}],expression:"['title',\n                 {rules: [\n                  { max: 50, message: '长度不能超过50个字符'},\n                  { required: true, message: '不能为空'}\n                ]}]"}]})],1),e._v(" "),o("a-form-item",e._b({attrs:{label:"URL"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["url",{rules:[{max:100,message:"长度不能超过100个字符"},{required:!0,message:"不能为空"}]}],expression:"[\n            'url',\n            {rules: [\n               { max: 100, message: '长度不能超过100个字符'},\n               { required: true, message: '不能为空'}\n            ]}]"}]})],1),e._v(" "),o("a-form-item",e._b({directives:[{name:"show",rawName:"v-show",value:1===e.value,expression:"value===1"}],attrs:{label:"AccessToken"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["token",{rules:[{max:100,message:"长度不能超过100个字符"}]}],expression:"[\n            'token',\n            {rules: [\n              { max: 100, message: '长度不能超过100个字符'}\n            ]}]"}]})],1)],1),e._v(" "),o("div",{staticClass:"drawer-bootom-button"},[o("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[o("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),o("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]},h=o("C7Lr")(d,u,!1,null,null,null);t.default=h.exports},GzWg:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("4YfN"),r=o.n(i),n=o("hJEr"),a=o("IkOO"),s=o("4ACn"),l=o("2bvH");o("avHd");var c={name:"Monitor",components:{MyPlayer:n.a,MonitorAdd:a.default,MonitorEdit:s.default},data:function(){return{current_user:this.$store.state.account.user,advanced:!1,dataSource:[],selectedRowKeys:[],queryParams:{},sortedInfo:null,loading:!1,paginationInfo:null,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e,t){return"显示 "+t[0]+" ~ "+t[1]+" 条记录，共 "+e+" 条记录"}},visible:!1,video:{url:"",title:""},monitorAddVisiable:!1,monitorEditVisiable:!1,w:600,h:400,isMonitor:!0,monitor:null,player:null}},computed:r()({},Object(l.c)({company:function(e){return e.account.company}}),{columns:function(){var e=this.sortedInfo;return[{title:"所属ID",dataIndex:"ownerId"},{title:"监控名称",dataIndex:"title"},{title:"接入地址",dataIndex:"url"},{title:"AccessToken",dataIndex:"token"},{title:"创建时间",dataIndex:"createTime",sorter:!0,sortOrder:"createTime"===(e=e||{}).columnKey&&e.order},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:120}]},rowSelection:function(){var e=this;return{onChange:function(t,o){e.selectedRowKeys=t},getCheckboxProps:function(t){return{props:{disabled:t.creator!==e.current_user.username,name:t.creator}}}}}}),mounted:function(){this.fetch()},methods:{addMonitor:function(){this.monitorAddVisiable=!0},handleMonitorAddClose:function(){this.monitorAddVisiable=!1},handleMonitorAddSuccess:function(){this.monitorAddVisiable=!1,this.$message.success("新增监控成功"),this.fetch()},eidtMonitor:function(e){this.monitorEditVisiable=!0,this.$refs.monitorEdit.setFormValues(e)},handleMonitorEditClose:function(){this.monitorEditVisiable=!1},handleMonitorEditSuccess:function(){this.monitorEditVisiable=!1,this.$message.success("修改监控成功"),this.fetch()},viewMonitor:function(e){var t=this;this.video.title=e.title,this.video.url=e.url,this.visible=!0,this.stopMonitor(),this.stopPlayer(),e.token?(this.isMonitor=!0,this.monitor=new EZUIKit.EZUIPlayer({id:"playWind",autoplay:!0,url:e.url,accessToken:e.token,decoderPath:"../",width:this.w,height:this.h})):(this.isMonitor=!1,this.src=e.url,setTimeout(function(){t.player=new EZUIKit.EZUIPlayer("myPlayer")},500))},handleCnacel:function(e){this.stopPlayer(),this.stopMonitor()},stopPlayer:function(){this.player&&(this.player.stop(),this.player=null,this.src=null)},stopMonitor:function(){this.monitor&&(this.monitor.stop(),this.monitor=null)},videoDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除！",centered:!0,onOk:function(){e.$delete("video/"+e.selectedRowKeys.join(",")).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.fetch()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},reset:function(){this.selectedRowKeys=[],this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(e,t,o){this.paginationInfo=e,this.filteredInfo=t,this.sortedInfo=o,this.fetch(r()({sortField:o.field,sortOrder:o.order},this.queryParams,t))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,t.creator=this.current_user.username,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,t.pageSize=this.paginationInfo.pageSize,t.pageNum=this.paginationInfo.current):(t.pageSize=this.pagination.defaultPageSize,t.pageNum=this.pagination.defaultCurrent),this.$get("video",r()({},t,{classify:1})).then(function(t){var o=t.data;e.dataSource=o.rows;var i=r()({},e.pagination);i.total=o.total,e.pagination=i,e.loading=!1})}}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[o("div",[o("div",{staticClass:"operator"},[o("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.addMonitor}},[e._v("新增")]),e._v(" "),o("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"video:delete",expression:"'video:delete'"}],attrs:{type:"primary",ghost:""},on:{click:e.videoDelete}},[e._v("删除")])],1),e._v(" "),o("a-table",{ref:"TableInfo",attrs:{columns:e.columns,dataSource:e.dataSource,rowKey:"videoId",pagination:e.pagination,loading:e.loading,scroll:{x:900},rowSelection:e.rowSelection},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"operation",fn:function(t,i){return[o("a-icon",{attrs:{type:"edit",theme:"twoTone",twoToneColor:"#faad14",title:"修改"},on:{click:function(t){e.eidtMonitor(i)}}}),e._v(" "),o("a-icon",{attrs:{type:"eye",theme:"twoTone",twoToneColor:"#42b983",title:"查看"},on:{click:function(t){e.viewMonitor(i)}}})]}}])})],1),e._v(" "),o("a-modal",{staticStyle:{"text-align":"center"},attrs:{title:e.video.title,width:700,footer:null,maskClosable:!1,okText:"播放",cancelText:"关闭"},on:{cancel:e.handleCnacel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.isMonitor,expression:"isMonitor"}],style:{width:e.w+"px",height:e.h+"px",display:"inline-block"},attrs:{id:"playWind"}}),e._v(" "),o("video",{directives:[{name:"show",rawName:"v-show",value:!e.isMonitor,expression:"!isMonitor"}],style:{width:e.w+"px",height:e.h+"px",display:"inline-block"},attrs:{id:"myPlayer",src:e.video.url,controls:"",playsInline:"","webkit-playsinline":"",autoplay:""}})]),e._v(" "),o("monitor-add",{attrs:{monitorAddVisiable:e.monitorAddVisiable,ownerId:e.company.companyId},on:{success:e.handleMonitorAddSuccess,close:e.handleMonitorAddClose}}),e._v(" "),o("monitor-edit",{ref:"monitorEdit",attrs:{monitorEditVisiable:e.monitorEditVisiable},on:{success:e.handleMonitorEditSuccess,close:e.handleMonitorEditClose}})],1)},staticRenderFns:[]};var u=o("C7Lr")(c,d,!1,function(e){o("JZNQ")},"data-v-79744118",null);t.default=u.exports},IkOO:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("ZLEe"),r=o.n(i),n={labelCol:{span:3},wrapperCol:{span:18}},a={name:"MonitorAdd",props:{monitorAddVisiable:{default:!1},ownerId:{}},data:function(){return{loading:!1,formItemLayout:n,form:this.$form.createForm(this),value:1}},methods:{onDateChange:function(e,t){this.produceDate=t},reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(t,o){if(!t){o.produceDate=e.produceDate,e.loading=!0,1!==e.value&&(o.token=null);var i={};r()(o).forEach(function(e){o[e]&&(i[e]=o[e])}),e.$post("video/monitor",i).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"新增监控",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.monitorAddVisiable},on:{close:e.onClose}},[o("a-form",{attrs:{form:e.form}},[o("a-form-item",e._b({attrs:{label:"企业编号"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ownerId",{initialValue:e.ownerId,rules:[{required:!0,message:"不能为空"}]}],expression:"['ownerId',\n                 {initialValue: ownerId,\n                   rules: [\n                  { required: true, message: '不能为空'}\n                ]}]"}],attrs:{readOnly:""}})],1),e._v(" "),o("a-form-item",e._b({attrs:{label:"类型"}},"a-form-item",e.formItemLayout,!1),[o("a-radio-group",{model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[o("a-radio",{attrs:{value:1}},[e._v("监控")]),e._v(" "),o("a-radio",{attrs:{value:2}},[e._v("直播")])],1)],1),e._v(" "),o("a-form-item",e._b({attrs:{label:"监控名称"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{max:50,message:"长度不能超过50个字符"},{required:!0,message:"不能为空"}]}],expression:"['title',\n                 {rules: [\n                  { max: 50, message: '长度不能超过50个字符'},\n                  { required: true, message: '不能为空'}\n                ]}]"}]})],1),e._v(" "),o("a-form-item",e._b({attrs:{label:"URL"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["url",{rules:[{max:100,message:"长度不能超过100个字符"},{required:!0,message:"不能为空"}]}],expression:"[\n            'url',\n            {rules: [\n               { max: 100, message: '长度不能超过100个字符'},\n               { required: true, message: '不能为空'}\n            ]}]"}]})],1),e._v(" "),o("a-form-item",e._b({directives:[{name:"show",rawName:"v-show",value:1===e.value,expression:"value===1"}],attrs:{label:"AccessToken"}},"a-form-item",e.formItemLayout,!1),[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["token",{rules:[{max:100,message:"长度不能超过100个字符"}]}],expression:"[\n            'token',\n            {rules: [\n              { max: 100, message: '长度不能超过100个字符'}\n            ]}]"}]})],1)],1),e._v(" "),o("div",{staticClass:"drawer-bootom-button"},[o("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[o("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),o("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]},l=o("C7Lr")(a,s,!1,null,null,null);t.default=l.exports},JZNQ:function(e,t){},"VC+f":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},avHd:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t,i,r=o("3cXf"),n=o.n(r),a=o("rVsN"),s=o.n(a),l=o("hRKE"),c=o.n(l);t="undefined"!=typeof window?window:this,i=function(t,o){!function(t,o){function i(){var e=g.elements;return"string"==typeof e?e.split(" "):e}function r(e){var t=v[e[f]];return t||(t={},m++,e[f]=m,v[m]=t),t}function n(e,t,i){return t||(t=o),d?t.createElement(e):(i||(i=r(t)),!(n=i.cache[e]?i.cache[e].cloneNode():p.test(e)?(i.cache[e]=i.createElem(e)).cloneNode():i.createElem(e)).canHaveChildren||h.test(e)||n.tagUrn?n:i.frag.appendChild(n));var n}function a(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(o){return g.shivMethods?n(o,e,t):t.createElem(o)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+i().join().replace(/[\w\-:]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function s(e){e||(e=o);var t=r(e);return!g.shivCSS||l||t.hasCSS||(t.hasCSS=!!function(e,t){var o=e.createElement("p"),i=e.getElementsByTagName("head")[0]||e.documentElement;return o.innerHTML="x<style>"+t+"</style>",i.insertBefore(o.lastChild,i.firstChild)}(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),d||a(e,t),e}var l,d,u=t.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",m=0,v={};!function(){try{var e=o.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,d=1==e.childNodes.length||function(){o.createElement("a");var e=o.createDocumentFragment();return void 0===e.cloneNode||void 0===e.createDocumentFragment||void 0===e.createElement}()}catch(e){l=!0,d=!0}}();var g={elements:u.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:"3.7.3",shivCSS:!1!==u.shivCSS,supportsUnknownElements:d,shivMethods:!1!==u.shivMethods,type:"default",shivDocument:s,createElement:n,createDocumentFragment:function(e,t){if(e||(e=o),d)return e.createDocumentFragment();for(var n=(t=t||r(e)).frag.cloneNode(),a=0,s=i(),l=s.length;l>a;a++)n.createElement(s[a]);return n},addElements:function(e,t){var o=g.elements;"string"!=typeof o&&(o=o.join(" ")),"string"!=typeof e&&(e=e.join(" ")),g.elements=o+" "+e,s(t)}};t.html5=g,s(o),"object"===c()(e)&&e.exports&&(e.exports=g)}(void 0!==t?t:this,document),
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
"document"in self&&("classList"in document.createElement("_")?function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var o,i=arguments.length;for(o=0;o<i;o++)e=arguments[o],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:o.call(this,e)}}e=null}():function(e){if("Element"in e){var t="classList",o="prototype",i=e.Element[o],r=Object,n=String[o].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[o].indexOf||function(e){for(var t=0,o=this.length;t<o;t++)if(t in this&&this[t]===e)return t;return-1},s=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},c=function(e){for(var t=n.call(e.getAttribute("class")||""),o=t?t.split(/\s+/):[],i=0,r=o.length;i<r;i++)this.push(o[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},d=c[o]=[],u=function(){return new c(this)};if(s[o]=Error[o],d.item=function(e){return this[e]||null},d.contains=function(e){return-1!==l(this,e+="")},d.add=function(){var e,t=arguments,o=0,i=t.length,r=!1;do{e=t[o]+"",-1===l(this,e)&&(this.push(e),r=!0)}while(++o<i);r&&this._updateClassName()},d.remove=function(){var e,t,o=arguments,i=0,r=o.length,n=!1;do{for(e=o[i]+"",t=l(this,e);-1!==t;)this.splice(t,1),n=!0,t=l(this,e)}while(++i<r);n&&this._updateClassName()},d.toggle=function(e,t){e+="";var o=this.contains(e),i=o?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!o},d.toString=function(){return this.join(" ")},r.defineProperty){var h={get:u,enumerable:!0,configurable:!0};try{r.defineProperty(i,t,h)}catch(e){-2146823252===e.number&&(h.enumerable=!1,r.defineProperty(i,t,h))}}else r[o].__defineGetter__&&i.__defineGetter__(t,u)}}(self)),Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var o in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[o]:("00"+t[o]).substr((""+t[o]).length)));return e};var i="https://open.ys7.com",r="https://log.ys7.com/statistics.do",a=i+"/sdk/js/2.0/js/ckplayer/ckplayer.js",l=i+"/sdk/js/2.0/js/flv.min.js",d="https:"===t.location.protocol,u=!!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|ios|SymbianOS)/i),h=document.createElement("video"),p=!!h.canPlayType&&!!t.addEventListener,f=p&&h.canPlayType("application/vnd.apple.mpegURL");function m(e){var o={Ver:"v.2.4.1",PlatAddr:t.location.protocol+"//"+t.location.host,ExterVer:"Ez.2.4.1",CltType:102,StartTime:(new Date).Format("yyyy-MM-dd hh:mm:ss.S"),OS:navigator.platform};for(var i in e)o[i]=e[i];var n=[];for(var a in o)n.push(a+"="+o[a]);var s="?"+n.join("&");(new Image).src=r+s}m({systemName:"open_netstream_localinfo"});var v=/^rtmp/;function g(e,t){var o=document.createElement("script");o.setAttribute("src",e),o.onload=t,document.getElementsByTagName("head")[0].appendChild(o)}function y(e,t,o,i){var r=e,n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=JSON.parse(n.responseText);i(e)}},n.open(t,r,!0);var a=new FormData;for(var s in o)a.append(s,o[s]);n.send(a)}function w(e,t){var o=new RegExp("(\\?|#|&)"+e+"=(.*?)(#|&|$)"),i=(t||location.href).match(o);return decodeURIComponent(i?i[2]:"")}function E(e){return!!e&&("object"===(void 0===e?"undefined":c()(e))||"function"==typeof e)&&"function"==typeof e.then}var b=function(e){if(!p)throw new Error("不支持ie8等低版本浏览器");if(this.opt={},this.opt.sources=[],this.handlers={},"object"===(void 0===e?"undefined":c()(e))&&e.decoderPath){if("string"!=typeof e.decoderPath||void 0===e.decoderPath)throw new Error("EZUIDecoder requires the path of decoder");if("string"!=typeof e.id||void 0===e.id)throw new Error("EZUIDecoder requires parameter id");if("string"!=typeof e.url||void 0===e.url)throw new Error("EZUIDecoder requires parameter url");this.opt.sources.push(e.url),this.opt.currentSource=this.opt.sources[0],e.env,this.jSPlugin={};var o=this,i=this.getRealUrl(e);E(i)&&i.then(function(){var t=o.initDecoder(e);E(t)&&!1!==e.autoplay&&t.then(function(){o.play({handleError:e.handleError})})}).catch(function(){var t=o.initDecoder(e);E(t)&&!1!==e.autoplay&&t.then(function(){})})}else{var r="";if("string"==typeof e?r=e:"object"===(void 0===e?"undefined":c()(e))&&(r=e.id),this.videoId=r,this.video=document.getElementById(r),!this.video)throw new Error("EZUIPlayer requires parameter videoId");var n=this.video.getElementsByTagName("source");n=Array.prototype.slice.call(n,0),this.video.src&&(u&&v.test(this.video.src)?(this.video.removeAttribute("src"),this.video.load()):this.opt.sources.push(this.video.src));var a=n.length;if(a>0)for(var s=0;s<a;s++)u&&v.test(n[s].src)?this.video.removeChild(n[s]):this.opt.sources.push(n[s].src);if(this.opt.sources.length<1)throw new Error("no source found in video tag.");this.opt.cur=0,this.opt.poster=this.video.poster;var l=(f=this.video,t.getComputedStyle?t.getComputedStyle(f,null):f.currentStyle),d=this.video.width,h=this.video.height;d?(this.opt.width=d,this.opt.height=h||"auto",this.log("video width:"+this.opt.width+" height:"+this.opt.height)):(this.opt.width=l.width,this.opt.height=l.height,this.log("videoStyle.width:"+l.width+" wideoStyle.height:"+l.height)),this.opt.parentId=r,this.opt.autoplay=!!this.video.autoplay,this.log("autoplay:"+this.video.autoplay),this.opt.currentSource=this.opt.sources[this.opt.cur],this.getRealUrl(e)}var f;this.handlers={},this.initTime=(new Date).getTime(),this.on("play",function(){m({systemName:"open_netstream_play_main",playurl:this.opt.currentSource,Time:(new Date).Format("yyyy-MM-dd hh:mm:ss.S"),Enc:0,PlTp:1,Via:2,ErrCd:0,Cost:(new Date).getTime()-this.initTime})}),this.retry=2,this.on("error",function(){m({systemName:"open_netstream_play_main",playurl:this.opt.currentSource,cost:-1,ErrCd:-1})})};b.prototype.on=function(e,t){"string"==typeof e&&"function"==typeof t&&(void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t))},b.prototype.emit=function(){if(this.handlers[arguments[0]]instanceof Array)for(var e=this.handlers[arguments[0]],t=e.length,o=0;o<t;o++)e[o].apply(this,Array.prototype.slice.call(arguments,1))},b.prototype.getRealUrl=function(e){var o=this,i="https://open.ys7.com";if(e&&e.env&&(i=e.env.domain),e&&e.decoderPath){var r=[],a=function(r){return new s.a(function(n,a){return function(r,n,a){var s="";if(/^ezopen:\/\//.test(a)){var l=i+"/jssdk/ezopen/getStreamToken?accessToken="+e.accessToken+"&num=10&type="+(-1!==e.url.indexOf("live")?"live":"playback"),c=function(e){if(0!==e.retcode)throw r("get realURL error"),new Error("获取播放token失败");s=s+e.data.params+"&ssn="+e.data.tokens[0],r(s)},u=i+"/api/lapp/live/url/ezopen",h="false";h=e&&e.env&&e.env.domain?-1!==e.env.domain.indexOf("https")?"false":"true":-1!==t.location.href.indexOf("https")?"false":"true",y(u,"POST",{ezopen:a,userAgent:t.navigator.userAgent,isFlv:!1,addressTypes:null,isHttp:h,accessToken:e.accessToken},function(e){if(200==e.code||0==e.retcode){var t=w("checkCode",e.data);if(t&&(o.opt.validateCode=t),s+=e.data,-1!==e.data.indexOf("playback")){if(w("begin",e.data))s=s.replace("&begin="+w("begin",e.data),"&begin="+d(w("begin",e.data),"000000"));else{var i=new Date;s=s+"&begin="+i.Format("yyyyMMdd")+"T000000Z"}w("end",e.data)?s=s.replace("&end="+w("end",e.data),"&end="+d(w("end",e.data),"235959")):(i=new Date,s=s+"&end="+i.Format("yyyyMMdd")+"T235959Z"),w("stream",e.data)||(s=s.replace("stream","&stream"))}y(l,"GET","",c)}else r("get realURL error")})}else r(a)}(n,0,r)})};return e.url.split(",").map(function(e){r.push(a(e))}),s.a.all(r).then(function(e){o.opt.sources=e,o.opt.currentSource=e[0]}).catch(function(){})}if(this.opt.currentSource)if(/^ezopen:\/\//.test(this.opt.currentSource)){if(!/^ezopen:\/\//.test(this.opt.currentSource))throw new Error("EZOPEN地址必须要以ezopen://开头");if(-1===this.opt.currentSource.indexOf(".com/"))throw new Error("EZOPEN地址格式不正确");if(!/[a-z\d]{32}(\.hd)?\.live/.test(this.opt.currentSource))throw new Error("EZOPEN地址格式uuid格式不正确");if(/(.*.hls.*|.*.m3u8.*|.*.wss.*|.*.flv.*|.*.rtmp.*){2,}/.test(this.opt.currentSource))throw new Error("EZOPEN地址多于两个播放协议");if(-1!==this.opt.currentSource.search(/(.hls|.m3u8|.wss|.flv|.rtmp)/)&&!/.live(.hls|.m3u8|.wss|.flv|.rtmp)/.test(this.opt.currentSource))throw new Error("请指定正确的播放协议");if(-1===this.opt.currentSource.search(/(.hls|.m3u8|.wss|.flv|.rtmp)/)&&!/[a-z\d]{32}(\.hd)?\.live$/.test(this.opt.currentSource))throw new Error("EZOPEN地址结尾不正确");var c=this;g(l,function(){var e={ezopen:c.opt.currentSource,userAgent:t.navigator.userAgent,isFlv:!(!flvjs||!flvjs.isSupported())&&flvjs.isSupported(),addressTypes:"HLS,RTMP,WS,FLV",isHttp:!(t.location.protocol.indexOf("s")>0)};m({ezopen:c.opt.currentSource,userAgent:t.navigator.userAgent,isFlv:!(!flvjs||!flvjs.isSupported())&&flvjs.isSupported(),addressTypes:"HLS,RTMP,WS,FLV",isHttp:!(t.location.protocol.indexOf("s")>0),systemName:"EZOPEN"}),c.log("---------------------------------------"),c.log("入参(ezopen)是：   "+e.ezopen),c.log("---------------------------------------"),c.log("入参(userAgent)是：   "+e.userAgent),c.log("---------------------------------------"),c.log("入参(isFlv)是：   "+e.isFlv),c.log("---------------------------------------"),c.log("入参(addressTypes)是：   "+e.addressTypes),c.log("---------------------------------------"),c.log("入参(isHttp)是：   "+e.isHttp),c.log("---------------------------------------");y(i+"/api/lapp/live/url/ezopen","POST",e,function(e){if(200!=e.code)throw console.log("平台获取播放地址错误"),c.log("data：   "+n()(e)),new Error(e.msg);c.log("播放地址是：   "+e.data),c.video.src=e.data,c.video.load(),c.tryPlay(e.data)})})}else this.tryPlay(this.opt.currentSource);else this.log("未找到合适的播放URL");function d(e,t){if(/^[0-9]{8}T[0-9]{6}Z$/.test(e))return e;if(/[0-9]{8,14}/.test(e)){var o=6-(14-e.length),i=t.length,r=e+t.substring(o,i);return r.slice(0,8)+"T"+r.slice(8)+"Z"}throw new Error("回放时间格式有误，请确认")}},b.prototype.tryPlay=function(e){if(this.log("开始尝试播放，播放配置参数为："),this.log(e),e&&"object"===(void 0===e?"undefined":c()(e))&&e.decoderPath);else{this.opt.currentSource=e;var t=this;if(/\.m3u8/.test(e))if(u||f)this.log("使用原生video"),this.video.style.heght=this.opt.height=9*Number(this.opt.width.replace(/px$/g,""))/16+"px",this.initVideoEvent();else{var o=-1!==e.indexOf("https");d&&!o?g(a,function(){t.initCKPlayer()}):g("https://open.ys7.com/sdk/js/2.0/js/hls.min.js",function(){Hls.isSupported()?(t.log("使用hls.js"),t.initHLS(e)):(t.log("2 使用flash"),g(a,function(){t.initCKPlayer()}))})}else/^rtmp:/.test(e)?u?(this.opt.cur++,this.tryPlay(e)):g(a,function(){t.initCKPlayer(e)}):/^wss:|^ws:/.test(e)?(i=navigator.userAgent).indexOf("compatible")>-1&&i.indexOf("MSIE")>-1?alert("WS协议不支持Ie11以下的浏览器！请使用IE11，或者更高版本的浏览器"):g("https://open.ys7.com/sdk/js/2.0/js/jsmpeg.min.js",function(){t.initJSmpeg(e)}):/\.flv/.test(this.opt.currentSource)&&g(l,function(){t.log("使用flv.js播放"),t.initflv()})}var i},b.prototype.initHLS=function(e){var t=this,o=new Hls({defaultAudioCodec:"mp4a.40.2"});o.loadSource(e),o.attachMedia(this.video),o.on(Hls.Events.MANIFEST_PARSED,function(){t.opt.autoplay&&t.video.play(),t.initVideoEvent()}),o.on(Hls.Events.ERROR,function(e,t){if(t.fatal)switch(t.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),o.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),o.recoverMediaError();break;default:o.destroy()}}),this.hls=o},b.prototype.log=function(e){this.emit("log",e)},b.prototype.initCKPlayer=function(){this.log("ckplayer初始化");var e=this,o={play:function(){e.emit("play")},pause:function(){e.emit("pause")},error:function(){e.emit("error")}};t.ckplayer_status=function(){e.log(arguments),o[arguments[0]]&&o[arguments[0]]()},this.videoFlash=document.createElement("DIV"),this.video.parentNode.replaceChild(this.videoFlash,this.video),this.video=this.videoFlash,this.videoFlash.id=this.opt.parentId;var i=null;i=/^rtmp/.test(this.opt.currentSource)?{f:this.opt.currentSource,c:0,p:this.opt.autoplay?1:0,i:this.opt.poster,lv:1,loaded:"loadHandler"}:/\.m3u8/.test(this.opt.currentSource)?{s:4,f:"https://open.ys7.com/sdk/js/2.0/js/ckplayer/m3u8.swf",a:this.opt.currentSource,c:0,lv:1,p:this.opt.autoplay?1:0,i:this.opt.poster,loaded:"loadHandler"}:{f:this.opt.currentSource,c:0,p:1,loaded:"loadHandler"};this.flashId=this.opt.parentId+"flashId",t.CKobject.embedSWF("https://open.ys7.com/sdk/js/2.0/js/ckplayer/ckplayer.swf",this.opt.parentId,this.flashId,this.opt.width,this.opt.height,i,{bgcolor:"#FFF",allowFullScreen:!0,allowScriptAccess:"always",wmode:"transparent"})},b.prototype.initVideoEvent=function(){var e,t,o,i,r=this,n={loadstart:function(e){r.log("loadstart...当浏览器开始查找音频/视频时..."),r.emit("loadstart",e)},durationchange:function(e){r.log("durationchange...当音频/视频的时长已更改时..."),r.emit("durationchange",e)},loadedmetadata:function(e){r.log("loadedmetadata...当浏览器已加载音频/视频的元数据时..."),r.emit("loadedmetadata",e)},loadeddata:function(e){r.log("loadeddata...当浏览器已加载音频/视频的当前帧时..."),r.emit("loadeddata",e)},progress:function(e){r.log("progress...当浏览器正在下载音频/视频时..."),r.emit("progress",e)},canplay:function(e){r.log("canplay...当浏览器可以播放音频/视频时..."),r.emit("canplay",e)},canplaythrough:function(e){r.log("canplaythrough...当浏览器可在不因缓冲而停顿的情况下进行播放时..."),r.emit("canplaythrough",e)},abort:function(e){r.log("abort...当音频/视频的加载已放弃时..."),r.emit("abort",e)},emptied:function(e){r.log("emptied...当目前的播放列表为空时..."),r.emit("emptied",e)},ended:function(e){r.log("ended...当目前的播放列表已结束时..."),r.emit("ended",e)},pause:function(e){r.log("pause...当音频/视频已暂停时..."),r.emit("pause",e)},play:function(e){r.log("play...当音频/视频已开始或不再暂停时..."),r.emit("play",e)},playing:function(e){r.log("playing...当音频/视频在已因缓冲而暂停或停止后已就绪时..."),r.emit("playing",e)},ratechange:function(e){r.log("ratechange...当音频/视频的播放速度已更改时..."),r.emit("ratechange",e)},seeked:function(e){r.log("seeked...当用户已移动/跳跃到音频/视频中的新位置时..."),r.emit("seeked",e)},seeking:function(e){r.log("seeking...当用户开始移动/跳跃到音频/视频中的新位置时..."),r.emit("seeking",e)},stalled:function(e){r.log("stalled...当浏览器尝试获取媒体数据，但数据不可用时..."),r.emit("stalled",e)},suspend:function(e){r.log("suspend...当浏览器刻意不获取媒体数据时..."),r.emit("suspend",e),r.opt.autoplay&&r.video.play()},timeupdate:function(e){r.emit("timeupdate",e)},volumechange:function(e){r.log("volumechange...当音量已更改时..."),r.emit("volumechange",e)},waiting:function(e){r.log("waiting...当视频由于需要缓冲下一帧而停止..."),r.emit("waiting",e)},error:function(e){r.log("error...当在音频/视频加载期间发生错误时..."),r.emit("error",e)}};for(var a in n)this.video.addEventListener(a,n[a],!1);e=this.video,t=!1,o=!1,i=0,e.addEventListener("loadeddata",function(){t=!0},!1),e.addEventListener("stalled",function(){i++,o||i>=2&&!t&&(e.load(),e.play(),t=!1,o=!1,i=0)},!1),e.addEventListener("playing",function(){o=!0})},b.prototype.initJSmpeg=function(e){var t;this.canvasEle=document.createElement("canvas"),this.canvasEle.style.width=this.opt.width,this.canvasEle.style.height=this.opt.height,this.video.parentNode.replaceChild(this.canvasEle,this.video),this.canvasEle.id=this.opt.parentId,t&&t.destroy&&t.destroy(),t=new JSMpeg.Player(e,{canvas:this.canvasEle}),this.JSmpeg=t},b.prototype.initflv=function(){if(!flvjs.isSupported())throw this.log("浏览器不支持flv播放"),new Error("浏览器不支持flv播放");var e=this.video;e.getAttribute("controls")||e.setAttribute("controls",!0);var t=flvjs.createPlayer({type:"flv",url:this.opt.currentSource,isLive:!0},{enableStashBuffer:!0,stashInitialSize:128,enableWorker:!0});t.attachMediaElement(e),t.load(),t.play(),this.flv=t},b.prototype.play=function(e){if(this.log("开始播放"+this.opt.currentSource),t.CKobject)this.opt.autoplay=!0,this.initCKPlayer();else if(this.video)this.hls?(this.opt.autoplay=!0,this.hls.startLoad(),this.video.play()):this.JSmpeg?this.JSmpeg.play():(this.opt.autoplay=!0,this.video.play());else if(this.jSPlugin){var o=function(e){return i.jSPlugin.JS_OpenSound(0),{websocketConnectUrl:e.split("?")[0].replace("/live","").replace("/playback",""),websocketStreamingParam:(-1===e.indexOf("/live")?"/playback?":"/live?")+e.split("?")[1]}},i=this;e&&void 0!==e.index?e.index.forEach(function(t){i.jSPlugin.JS_Play(o(i.opt.sources[t]).websocketConnectUrl,{playURL:o(i.opt.sources[t]).websocketStreamingParam},t).then(function(){console.log("realplay success"),e&&e.handleSuccess&&e.handleSuccess()},function(t){if(console.log("realplay failed",t.oError),e&&e.handleError){var o=t.oError;e.handleError(o)}})}):i.opt.sources.forEach(function(t,r){i.jSPlugin.JS_Play(o(t).websocketConnectUrl,{playURL:o(t).websocketStreamingParam},r).then(function(){console.log("realplay success"),e&&e.handleSuccess&&(e.handleSuccess(),i.jSPlugin.JS_OpenSound(0))},function(t){if(console.log("realplay failed",t.oError),e&&e.handleError){var o=JSON.parse(i.errorCode).find(function(e){return e.detailCode.substr(-4)==t.oError.errorCode});e.handleError({retcode:t.oError.errorCode,msg:o?o.description:"其他错误"})}})})}},b.prototype.initDecoder=function(e){this.opt.id=e.id,this.log("初始化解码器---开始");var o=this;return new s.a(function(i){function r(e){if(200==e.code){if(!t.localStorage)return!1;var i=t.localStorage;i.errorCode=n()(e.data),o.errorCode=i.errorCode}}if(g(e.decoderPath+"/js/jsPlugin-1.2.0_test.js",function(){o.log("下载解码器完成，开始初始化"),o.jSPlugin=new JSPlugin({szId:e.id,iType:1,iWidth:e.width||600,iHeight:e.height||400,iMaxSplit:4,iCurrentSplit:e.splitBasis||1,szBasePath:e.decoderPath+"/js/"}),o.log("初始化解码器----完成"),o.log("开始设置秘钥");var t=o.opt.validateCode;t&&o.jSPlugin.JS_SetSecretKey(0,t),i("200 OK")}),t.localStorage){var a=t.localStorage;a.errorCode?o.errorCode=a.errorCode:y(e.decoderPath+"/js/errorCode.json","get",{language:1,time:(new Date).getTime(),appKey:"26810f3acd794862b608b6cfbc32a6b8"},r)}else y(e.decoderPath+"/js/errorCode.json","get",{language:1,time:(new Date).getTime(),appKey:"26810f3acd794862b608b6cfbc32a6b8"},r)})},b.prototype.stop=function(e){if(this.log("停止播放"+this.opt.currentSource),this.opt.autoplay=!1,t.CKobject)this.video.src="";else if(this.video)this.hls?(this.video.pause(),this.video.src="",this.hls.stopLoad()):this.flv?(this.flv.pause(),this.flv.unload(),this.flv.detachMediaElement(),this.flv.destroy(),this.flv=null):this.JSmpeg&&this.JSmpeg.stop();else if(this.jSPlugin){var o=function(e){for(var t=document.getElementById(i.opt.id).childNodes[0].childNodes[e],o=t.childNodes,r=o.length-1;r>=0;r--)t.removeChild(o[r])},i=this;if(void 0===e)for(var r=this.opt.sources.length,n=0;n<r;n++)this.jSPlugin.JS_Stop(n).then(function(){i.log("停止播放成功"+i.opt.currentSource),console.log("stop success")},function(){i.log("停止播放失败"+i.opt.currentSource),console.log("stop failed")}),o(n);else this.jSPlugin.JS_Stop(e).then(function(){i.log("停止播放成功"+i.opt.currentSource),console.log("stop success")},function(){i.log("停止播放失败"+i.opt.currentSource),console.log("stop failed")}),o(e)}},b.prototype.pause=function(){this.opt.autoplay=!1,t.CKobject?CKobject.getObjectById(this.flashId).videoPause():this.video?this.JSmpeg?this.JSmpeg.pause():this.video.pause():this.jSPlugin&&this.jSPlugin.JS_Pause(0).then(function(){},function(){})},b.prototype.load=function(){t.CKobject||this.video&&this.video.load()};var S=function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,t.AudioContext=t.AudioContext||t.webkitAudioContext},k=function(e){if(e&&"object"!==(void 0===e?"undefined":c()(e)))throw new Error("EZUITalk requires parameter it doesn't right");var o,i=e.id,r=e.token,a=e.uuid;if("string"!=typeof i||void 0===i)throw new Error("EZUITalk requires parameter audioId");if(this.audio=document.getElementById(i),!this.audio)throw new Error("EZUITalk requires parameter audioElement");if(!r)throw new Error("EZUITalk requires parameter accessToken");if(!a)throw new Error("EZUITalk requires parameter uuid");if(S(),!navigator.getUserMedia)throw new Error("当前浏览器不支持录音功能");if(!{trident:(o=t.navigator.userAgent).indexOf("Trident")>-1,presto:o.indexOf("Presto")>-1,webKit:o.indexOf("AppleWebKit")>-1,gecko:o.indexOf("Gecko")>-1&&-1===o.indexOf("KHTML"),mobile:!!o.match(/AppleWebKit.*Mobile.*/),ios:!!o.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:o.indexOf("Android")>-1||o.indexOf("Adr")>-1,iPhone:o.indexOf("iPhone")>-1,iPad:o.indexOf("iPad")>-1,webApp:-1==o.indexOf("Safari"),weixin:o.indexOf("MicroMessenger")>-1,qq:" qq"==o.match(/\sQQ/i),ie:o.indexOf("Trident")>-1||o.indexOf("MSIE")>-1||o.indexOf("compatible")>-1}.mobile)throw new Error("对讲功能仅在手机中支持进行对讲");this.handlers={};var s=this;this.BUFFER=[],this.encoder=void 0,this.isEnded=!0,this.LENGTH=20,this.audio.addEventListener("ended",function(){s.isEnded=!0}),this.audioPlay=function(){if(this.isEnded){this.isEnded=!1,this.BUFFER.length>this.LENGTH&&(this.BUFFER=this.BUFFER.slice(0,this.LENGTH)),this.encoder=new WavAudioEncoder(16e3,1);for(var e=this.BUFFER.shift();e;)this.encoder.encode(e),e=this.BUFFER.shift();this.audio.src=URL.createObjectURL(this.encoder.finish())}},this.start=function(){this.wsUrl="wss://test2.ys7.com:20007/opentalk/"+a,this.socket=new WebSocket(this.wsUrl),this.talk()},this.talk=function(){g("https://open.ys7.com/sdk/js/2.0/js/wav-audio-encoder.js",function(){s.socket.onopen=function(){s.log("websocket已连接");var e={accessToken:r,uuid:a},t=n()(e);s.socket.send(t),s.log("websocket 发送文本数据"),s.startRecord()},s.socket.onclose=function(){s.log("websocket已关闭")},s.socket.onerror=function(e){s.log("websocket出错->"+n()(e))},s.socket.onmessage=function(e){s.log("websocket 接收数据"),s.BUFFER.push(e.data),s.audioPlay()},s.audio.setAttribute("autoplay",!0),s.audio.play()})},this.startRecord=function(){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){var t=new AudioContext,o=t.createMediaStreamSource(e),i=t.createScriptProcessor(16384,1,1);s.log("当前浏览器采样率为： "+t.sampleRate),i.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);r.postMessage({cmd:"encode",buf:t})};var r=new Worker("../js/worker.js");r.onmessage=function(e){switch(e.data.cmd){case"pcm":s.socket.send(e.data.buf),console.log(e.data.buf),s.log("websocket 发送数据");break;default:s.log("未知信息："+e.data)}},i&&o&&(o.connect(i),i.connect(t.destination)),s.log("开始对讲"),s.stop=function(){i&&o&&(o.disconnect(),i.disconnect()),s.socket.close(),s.log("结束对讲")}}).catch(function(e){var t;switch(e.code||e.name){case"PermissionDeniedError":case"PERMISSION_DENIED":case"NotAllowedError":t="用户拒绝访问麦克风";break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":t="浏览器不支持麦克风";break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":t="找不到麦克风设备";break;default:t="无法打开麦克风，异常信息:"+(e.code||e.name)}s.log(t),alert(t)})}};k.prototype.on=function(e,t){"string"==typeof e&&"function"==typeof t&&(void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t))},k.prototype.emit=function(){if(this.handlers[arguments[0]]instanceof Array)for(var e=this.handlers[arguments[0]],t=e.length,o=0;o<t;o++)e[o].apply(this,Array.prototype.slice.call(arguments,1))},k.prototype.log=function(e){this.emit("log",e)};var x={EZUIPlayer:b,EZUITalk:k};return o||(t.EZUIKit=x,t.EZUIPlayer=b),x},"object"===c()(e)&&"object"===c()(e.exports)?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("EZUIPlayer requires a window with a document");return i(e)}:i(t)}.call(t,o("VC+f")(e))},hJEr:function(e,t,o){"use strict";var i={render:function(){var e=this.$createElement;return(this._self._c||e)("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{playsinline:!0,options:this.playerOptions}})},staticRenderFns:[]},r=o("C7Lr")({name:"MyPlayer",props:{url:""},data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"",src:this.url}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},watch:{url:function(e,t){e&&(this.playerOptions.sources[0].src=e)}}},i,!1,null,null,null);t.a=r.exports}});
//# sourceMappingURL=1.120ab6ba0a79de77cea5.js.map