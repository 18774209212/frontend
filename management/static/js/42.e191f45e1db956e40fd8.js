webpackJsonp([42],{TOiK:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("4YfN"),i=e.n(n),o={name:"Apply",components:{Info:e("JABh").a},data:function(){return{current_user:this.$store.state.account.user,advanced:!1,dataSource:[],queryParams:{},sortedInfo:null,loading:!1,batchId:null,applyId:null,qrVisible:!1,qrLoading:!1,size:128,paginationInfo:null,info:{visiable:!1,label:{top:{batchId:"批次号",num:"申请数量",startId:"码段开始值",endId:"码段结束值",applyTime:"申请时间",auditTime:"审核时间",status:"状态"}},data:{}},pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(t,a){return"显示 "+a[0]+" ~ "+a[1]+" 条记录，共 "+t+" 条记录"}}}},computed:{columns:function(){var t=this.sortedInfo;return[{title:"批次号",dataIndex:"batchId"},{title:"申请数量",dataIndex:"num"},{title:"申请人",dataIndex:"applicant"},{title:"码段开始值",dataIndex:"startId"},{title:"码段结束值",dataIndex:"endId"},{title:"申请时间",dataIndex:"applyTime",sorter:!0,sortOrder:"applyTime"===(t=t||{}).columnKey&&t.order},{title:"审核时间",dataIndex:"auditTime"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:120}]}},mounted:function(){this.fetch()},methods:{view:function(t){this.info.data=t,this.info.visiable=!0},handleInfoClose:function(){this.info.visiable=!1},downloadQrUrl:function(t){var a=document.createElement("iframe");a.src="api/anon/apply/generateCodeUrl?applyId="+t,a.style.display="none",document.body.appendChild(a)},showQrModal:function(t,a){this.batchId=t,this.applyId=a,this.qrVisible=!0},qrOk:function(){var t=document.createElement("iframe");t.src="api/anon/apply/generateCode?applyId="+this.applyId+"&size="+this.size,t.style.display="none",document.body.appendChild(t)},search:function(){var t=this.sortedInfo,a=void 0,e=void 0;t&&(a=t.field,e=t.order),this.fetch(i()({sortField:a,sortOrder:e},this.queryParams))},reset:function(){this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(t,a,e){this.paginationInfo=t,this.filteredInfo=a,this.sortedInfo=e,this.fetch(i()({sortField:e.field,sortOrder:e.order},this.queryParams,a))},fetch:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,a.pageSize=this.paginationInfo.pageSize,a.pageNum=this.paginationInfo.current):(a.pageSize=this.pagination.defaultPageSize,a.pageNum=this.pagination.defaultCurrent),this.$get("apply/page",i()({},a)).then(function(a){var e=a.data;t.dataSource=e.rows;var n=i()({},t.pagination);n.total=e.total,t.pagination=n,t.loading=!1})}}},r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[e("div",{class:t.advanced?"search":null},[e("a-form",{attrs:{layout:"horizontal"}},[e("div",{class:t.advanced?null:"fold"},[e("a-row",[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{label:"批次号",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[e("a-input",{model:{value:t.queryParams.batchId,callback:function(a){t.$set(t.queryParams,"batchId",a)},expression:"queryParams.batchId"}})],1)],1),t._v(" "),e("a-col",{attrs:{md:12,sm:24}},[e("span",{staticStyle:{float:"left","margin-top":"3px","margin-left":"15px"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")]),t._v(" "),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.reset}},[t._v("重置")])],1)])],1)],1)])],1),t._v(" "),e("div",[e("a-table",{ref:"TableInfo",attrs:{columns:t.columns,dataSource:t.dataSource,rowKey:"applyId",pagination:t.pagination,loading:t.loading,scroll:{x:900}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"status",fn:function(a){return e("span",{},[0===a?e("a-tag",{attrs:{color:"blue"}},[t._v("审核中")]):1===a?e("a-tag",{attrs:{color:"green"}},[t._v("申请成功")]):2===a?e("a-tag",{attrs:{color:"red"}},[t._v("审核不通过")]):t._e()],1)}},{key:"operation",fn:function(a,n){return[e("a-icon",{attrs:{type:"eye",theme:"twoTone",twoToneColor:"#42b983",title:"查看"},on:{click:function(a){t.view(n)}}}),t._v(" "),1===n.status?e("a-icon",{attrs:{type:"qrcode",title:"下载二维码图片"},on:{click:function(a){t.showQrModal(n.batchId,n.applyId)}}}):t._e(),t._v(" "),1===n.status?e("a-icon",{attrs:{title:"下载二维码URL",type:"file-text"},on:{click:function(a){t.downloadQrUrl(n.applyId)}}}):t._e()]}}])})],1),t._v(" "),e("info",{attrs:{data:t.info.data,label:t.info.label,infoVisiable:t.info.visiable},on:{close:t.handleInfoClose}}),t._v(" "),e("a-modal",{attrs:{title:"生成二维码",confirmLoading:t.qrLoading,okText:t.qrLoading?"生成中":"确认",cancelText:"取消"},on:{ok:t.qrOk},model:{value:t.qrVisible,callback:function(a){t.qrVisible=a},expression:"qrVisible"}},[t._v("\n    请输入二维码尺寸：\n    "),e("a-input-number",{attrs:{min:10,max:300},model:{value:t.size,callback:function(a){t.size=a},expression:"size"}})],1)],1)},staticRenderFns:[]};var s=e("C7Lr")(o,r,!1,function(t){e("kY0M")},"data-v-04060baa",null);a.default=s.exports},kY0M:function(t,a){}});
//# sourceMappingURL=42.e191f45e1db956e40fd8.js.map