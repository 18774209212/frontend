webpackJsonp([16],{VoD4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("4YfN"),i=a.n(n),o={name:"Video",components:{MyPlayer:a("hJEr").a},data:function(){return{current_user:this.$store.state.account.user,advanced:!1,dataSource:[],selectedRowKeys:[],queryParams:{},sortedInfo:null,loading:!1,paginationInfo:null,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e,t){return"显示 "+t[0]+" ~ "+t[1]+" 条记录，共 "+e+" 条记录"}},visible:!1,video:{url:"",title:""}}},computed:{columns:function(){var e=this.sortedInfo;return[{title:"视频ID",dataIndex:"videoId"},{title:"所属ID",dataIndex:"ownerId"},{title:"标题",dataIndex:"title"},{title:"视频地址",dataIndex:"url"},{title:"创建时间",dataIndex:"createTime",sorter:!0,sortOrder:"createTime"===(e=e||{}).columnKey&&e.order},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:120}]},rowSelection:function(){var e=this;return{onChange:function(t,a){e.selectedRowKeys=t},getCheckboxProps:function(t){return{props:{disabled:t.creator!==e.current_user.username,name:t.creator}}}}}},mounted:function(){this.fetch()},methods:{view:function(e){this.video.title=e.title,this.video.url=e.url,this.visible=!0},handleOk:function(e){this.visible=!1},videoDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除！",centered:!0,onOk:function(){e.$delete("video/"+e.selectedRowKeys.join(",")).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.fetch()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},search:function(){var e=this.sortedInfo,t=void 0,a=void 0;e&&(t=e.field,a=e.order),this.fetch(i()({sortField:t,sortOrder:a},this.queryParams))},reset:function(){this.selectedRowKeys=[],this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(e,t,a){this.paginationInfo=e,this.filteredInfo=t,this.sortedInfo=a,this.fetch(i()({sortField:a.field,sortOrder:a.order},this.queryParams,t))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,t.creator=this.current_user.username,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,t.pageSize=this.paginationInfo.pageSize,t.pageNum=this.paginationInfo.current):(t.pageSize=this.pagination.defaultPageSize,t.pageNum=this.pagination.defaultCurrent),this.$get("video",i()({},t,{classify:0})).then(function(t){var a=t.data;e.dataSource=a.rows;var n=i()({},e.pagination);n.total=a.total,e.pagination=n,e.loading=!1})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced?null:"fold"},[a("a-row",[a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"标题",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:e.queryParams.title,callback:function(t){e.$set(e.queryParams,"title",t)},expression:"queryParams.title"}})],1)],1),e._v(" "),a("a-col",{attrs:{md:12,sm:24}},[a("span",{staticStyle:{float:"left","margin-top":"3px","margin-left":"15px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)])],1)],1)])],1),e._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"video:delete",expression:"'video:delete'"}],attrs:{type:"primary",ghost:""},on:{click:e.videoDelete}},[e._v("删除")])],1),e._v(" "),a("a-table",{ref:"TableInfo",attrs:{columns:e.columns,dataSource:e.dataSource,rowKey:"videoId",pagination:e.pagination,loading:e.loading,scroll:{x:900},rowSelection:e.rowSelection},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"operation",fn:function(t,n){return[e.current_user.username===n.creator?a("div",[a("a-icon",{attrs:{type:"eye",theme:"twoTone",twoToneColor:"#42b983",title:"查看"},on:{click:function(t){e.view(n)}}})],1):a("a-badge",{attrs:{status:"warning",text:"无权限"}})]}}])})],1),e._v(" "),a("a-modal",{attrs:{title:e.video.title,footer:null},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("my-player",{attrs:{url:e.video.url}})],1)],1)},staticRenderFns:[]};var s=a("C7Lr")(o,r,!1,function(e){a("Yunh")},"data-v-77255cb5",null);t.default=s.exports},Yunh:function(e,t){},hJEr:function(e,t,a){"use strict";var n={render:function(){var e=this.$createElement;return(this._self._c||e)("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{playsinline:!0,options:this.playerOptions}})},staticRenderFns:[]},i=a("C7Lr")({name:"MyPlayer",props:{url:""},data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"",src:this.url}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},watch:{url:function(e,t){e&&(this.playerOptions.sources[0].src=e)}}},n,!1,null,null,null);t.a=i.exports}});
//# sourceMappingURL=16.bc3ec832e0dc22e0bbe2.js.map