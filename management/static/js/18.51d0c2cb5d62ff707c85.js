webpackJsonp([18,69],{"+RUo":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("4YfN"),n=a.n(i),s=a("2bvH"),o=a("ryJa"),r=a.n(o),l=a("LgPp"),c=a("ONu+"),d=a("h+i8");r.a.locale("zh-cn");var m={name:"CompanyInfo",components:{ImageAdd:l.default,UpdatePic:c.default,CompanyEdit:d.default},data:function(){return{userRole:"",imageAddVisiable:!1,initData:{},updatePicVisiable:!1,updatePicData:{},companyEditVisiable:!1,honors:[],qualities:[],environments:[]}},computed:n()({},Object(s.c)({multipage:function(t){return t.setting.multipage},user:function(t){return t.account.user},company:function(t){return t.account.company}})),methods:n()({editCompany:function(){this.companyEditVisiable=!0,this.$refs.companyEdit.setFormValues(this.company)},handleCompanyEditClose:function(){this.companyEditVisiable=!1},handleCompanyEditSuccess:function(){this.companyEditVisiable=!1,this.$message.success("修改企业成功"),this.getCompany()},addHonor:function(){this.initData.ownerId=this.company.companyId,this.initData.label="honor",this.initData.headTitle="添加荣誉资质",this.imageAddVisiable=!0},addQuality:function(){this.initData.ownerId=this.company.companyId,this.initData.label="quality",this.initData.headTitle="添加质量体系认证",this.imageAddVisiable=!0},addEnvironment:function(){this.initData.ownerId=this.company.companyId,this.initData.label="environment",this.initData.headTitle="添加生产环境",this.imageAddVisiable=!0},handleImageAddClose:function(){this.imageAddVisiable=!1},handleImageAddSuccess:function(){this.imageAddVisiable=!1,this.$message.success("添加成功"),this.fetch()},updateBrand:function(){this.updatePicData={companyId:this.company.companyId,field:"brand",headTitle:"修改商标"},this.updatePicVisiable=!0},updatePic:function(t,e){this.updatePicData={companyId:this.company.companyId,field:"picture",headTitle:"修改公司图片"},this.updatePicVisiable=!0},handleUpdatePicClose:function(){this.updatePicVisiable=!1},handleUpdatePicSuccess:function(){this.updatePicVisiable=!1,this.$message.success("修改成功"),this.getCompany()}},Object(s.b)({setCompany:"account/setCompany"}),{getCompany:function(){var t=this;this.$get("admin/company/"+this.company.companyId).then(function(e){t.setCompany(e.data)})},fetch:function(){var t=this;this.$get("anon/image/list",{ownerId:this.user.companyId}).then(function(e){for(var a,i=e.data,n=[],s=[],o=[],r=0,l=i.length;r<l;r++)"honor"===(a=i[r]).label?n.push(a):"quality"===a.label?s.push(a):"environment"===a.label&&o.push(a);t.honors=n,t.qualities=s,t.environments=o})}}),mounted:function(){this.fetch()}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"100%"}},[a("a-row",{attrs:{gutter:8}},[a("a-card",{staticStyle:{"margin-top":"1rem"},attrs:{title:"企业信息"}},[a("a-icon",{attrs:{slot:"extra",type:"edit",theme:"twoTone",twoToneColor:"#faad14",title:"编辑企业信息"},on:{click:t.editCompany},slot:"extra"}),t._v(" "),a("a-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{slot:"extra"},slot:"extra"},[a("a",{staticClass:"ant-dropdown-link"},[a("a-icon",{attrs:{type:"plus"}})],1),t._v(" "),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{on:{click:t.addHonor}},[t._v("添加荣誉资质")])]),t._v(" "),a("a-menu-item",[a("a",{on:{click:t.addQuality}},[t._v("添加质量体系认证")])]),t._v(" "),a("a-menu-item",[a("a",{on:{click:t.addEnvironment}},[t._v("添加生产环境")])])],1)],1),t._v(" "),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{span:6}},[a("a-row",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{width:"10rem","border-radius":"2px"},attrs:{alt:"商标",src:t.company.brand}})]),t._v(" "),a("a-row",{staticStyle:{"text-align":"center","margin-top":"1rem"}},[a("a-button",{attrs:{icon:"edit"},on:{click:t.updateBrand}},[t._v("修改商标")])],1),t._v(" "),a("a-row",{staticStyle:{"text-align":"center","margin-top":"1rem"}},[a("img",{staticStyle:{width:"10rem","border-radius":"2px"},attrs:{alt:"图片",src:t.company.picture}})]),t._v(" "),a("a-row",{staticStyle:{"text-align":"center","margin-top":"1rem"}},[a("a-button",{attrs:{icon:"edit"},on:{click:t.updatePic}},[t._v("修改图片")])],1)],1),t._v(" "),a("a-col",{staticStyle:{"font-size":"1rem"},attrs:{span:12}},[a("p",[t._v("企业名："+t._s(t.company.companyName))]),t._v(" "),a("p",[t._v("联系人："+t._s(t.company.linkman))]),t._v(" "),a("p",[t._v("联系电话："+t._s(t.company.linkphone))]),t._v(" "),a("p",[t._v("地址："+t._s(t.company.province)+t._s(t.company.city)+t._s(t.company.area))]),t._v(" "),a("p",[t._v("详细地址："+t._s(t.company.address))]),t._v(" "),a("p",[t._v("邮编："+t._s(t.company.postcode))]),t._v(" "),a("p",[t._v("经纬度："+t._s(t.company.lng)+", "+t._s(t.company.lat))]),t._v(" "),a("p",[t._v("创建时间："+t._s(t.company.createTime))])])],1),t._v(" "),a("a-row",[a("a-col",[a("a-divider",{attrs:{orientation:"left"}},[t._v("企业简介")]),t._v(" "),a("div",{staticStyle:{"text-indent":"1rem","margin-bottom":"2rem"}},[t._v(t._s(t.company.introduce))])],1)],1),t._v(" "),a("a-row",[a("a-col",[a("a-divider",{attrs:{orientation:"left"}},[t._v("企业荣誉")]),t._v(" "),a("a-list",{staticClass:"honor",attrs:{grid:{gutter:16,column:4},dataSource:t.honors},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{"max-width":"100%",height:"200px"},attrs:{src:e.imageUrl}}),t._v(" "),a("div",[t._v(t._s(e.title))])])])}}])})],1)],1),t._v(" "),a("a-row",[a("a-col",[a("a-divider",{attrs:{orientation:"left"}},[t._v("企业环境")]),t._v(" "),a("a-list",{staticClass:"honor",attrs:{grid:{gutter:16,column:4},dataSource:t.environments},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{"max-width":"100%",height:"200px"},attrs:{src:e.imageUrl}}),t._v(" "),a("div",[t._v(t._s(e.title))])])])}}])})],1)],1),t._v(" "),a("a-row",[a("a-col",[a("a-divider",{attrs:{orientation:"left"}},[t._v("质量体系认证")]),t._v(" "),a("a-list",{staticClass:"honor",attrs:{grid:{gutter:16,column:4},dataSource:t.qualities},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{"max-width":"100%",height:"200px"},attrs:{src:e.imageUrl}}),t._v(" "),a("div",[t._v(t._s(e.title))])])])}}])})],1)],1)],1)],1),t._v(" "),a("image-add",{attrs:{imageAddVisiable:t.imageAddVisiable,initData:t.initData},on:{success:t.handleImageAddSuccess,close:t.handleImageAddClose}}),t._v(" "),a("update-pic",{attrs:{updatePicVisiable:t.updatePicVisiable,initData:t.updatePicData},on:{success:t.handleUpdatePicSuccess,close:t.handleUpdatePicClose}}),t._v(" "),a("company-edit",{ref:"companyEdit",attrs:{companyEditVisiable:t.companyEditVisiable},on:{success:t.handleCompanyEditSuccess,close:t.handleCompanyEditClose}})],1)},staticRenderFns:[]};var p=a("C7Lr")(m,u,!1,function(t){a("zUnJ")},null,null);e.default=p.exports},"ONu+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("ZLEe"),n=a.n(i),s={labelCol:{span:3},wrapperCol:{span:18}},o={name:"UpdatePic",components:{UploadImage:a("AS2Z").a},props:{updatePicVisiable:{default:!1},initData:{default:{}}},data:function(){return{loading:!1,formItemLayout:s,form:this.$form.createForm(this),fileList:[]}},methods:{handleFileSelect:function(t){this.fileList.push(t)},handleFileRemove:function(t){this.fileList.splice(t,1)},reset:function(){this.loading=!1,this.form.resetFields(),this.fileList=[],this.$refs.uploadImageChild.finished()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var t=this;this.form.validateFields(function(e,a){if(!e){t.loading=!0;var i=new FormData;n()(a).forEach(function(t){a[t]&&i.append(t,a[t])}),t.fileList.forEach(function(t,e){var a=t.type.split("/")[1];i.append("file",t,"file_"+Date.parse(new Date)+"."+a)}),t.$upload("admin/company/updatePic",i).then(function(){t.reset(),t.$emit("success")}).catch(function(){t.loading=!1})}})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:t.initData.headTitle,maskClosable:!1,width:"650",placement:"right",closable:!1,visible:t.updatePicVisiable},on:{close:t.onClose}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",t._b({attrs:{label:"企业编号"}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["companyId",{initialValue:t.initData.companyId,rules:[{required:!0,message:"不能为空"}]}],expression:"['companyId',\n                 {initialValue: initData.companyId,\n                   rules: [\n                  { required: true, message: '不能为空'}\n                ]}]"}],attrs:{readOnly:""}})],1),t._v(" "),a("a-form-item",t._b({attrs:{label:"图片类型"}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["field",{initialValue:t.initData.field,rules:[{required:!0,message:"不能为空"}]}],expression:"['field',\n                 {initialValue: initData.field,\n                   rules: [{ required: true, message: '不能为空'}\n                ]}]"}],attrs:{readOnly:""}})],1),t._v(" "),a("a-form-item",t._b({attrs:{label:"图片"}},"a-form-item",t.formItemLayout,!1),[a("upload-image",{ref:"uploadImageChild",attrs:{limitNum:"1"},on:{fileSelect:t.handleFileSelect,fileRemove:t.handleFileRemove}})],1)],1),t._v(" "),a("div",{staticClass:"drawer-bootom-button"},[a("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:t.onClose}},[a("a-button",{staticStyle:{"margin-right":".8rem"}},[t._v("取消")])],1),t._v(" "),a("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)},staticRenderFns:[]},l=a("C7Lr")(o,r,!1,null,null,null);e.default=l.exports},zUnJ:function(t,e){}});
//# sourceMappingURL=18.51d0c2cb5d62ff707c85.js.map